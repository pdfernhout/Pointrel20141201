<html>
<head>
<script src="//ajax.googleapis.com/ajax/libs/dojo/1.10.1/dojo/dojo.js"></script>
</head>
<body>
Test of PUT-ing a resource.

<script>
console.log("starting up...");
require(["./pointrel20141201Client.js"], function(pointrel20141201Client) {
    "use strict";
    
    console.log("pointrel20141201Client", pointrel20141201Client);
        
    var testObject1 = {foo: "bar", id: 3};

    pointrel20141201Client.storeInNewEnvelope(testObject1, "3", null, null, function(error, result) {
        if (error) { console.log("error", error); return;}
        
        console.log("Stored item", result.sha256AndLength);
      
        var sha256AndLengthExpected1 = "370a575ef3c65d833e204f3930680a931c5f911088d65b513f18f21e85228704_126";
      
        console.log("match expected 1?", sha256AndLengthExpected1 === result.sha256AndLength); 
      
        // Get an object by sha256AndLength
        pointrel20141201Client.fetchEnvelope(sha256AndLengthExpected1, function(error, item) {
            if (error) { console.log("error", error); return;}
            console.log("Got item", item);
        });
    });
    
    var testObject2Content = "Hello, world!";
    var testObject2ID = "hello world";
    var testObject2Tags = ["test", "pointrel://pages/hello-world.txt"];
    var testObject2ContentType = "text/plain";

    pointrel20141201Client.storeInNewEnvelope(testObject2Content, testObject2ID, testObject2Tags, testObject2ContentType, function(error, result) {
        if (error) { console.log("error", error); return;}
        
        console.log("Stored item", result.sha256AndLength);
      
        var sha256AndLengthExpected2 = "ade2977d39fcc2a70920fc123ac9603148030fb9883d1e8e14a9bd6dbe46b04b_215";
      
        console.log("match expected 2?", sha256AndLengthExpected2 === result.sha256AndLength); 
      
        pointrel20141201Client.fetchEnvelope(result.sha256AndLength, function(error, item) {
            if (error) { console.log("error", error); return;}
            console.log("Got item", item);
        });
    });
    
    pointrel20141201Client.queryByID("hello world", function(error, queryResult) {
        if (error) { console.log("error", error); return;}
        console.log("Got queryResult for id 'hello world'", queryResult);
    });
    
    pointrel20141201Client.queryByTag("test", function(error, queryResult) {
        if (error) { console.log("error", error); return;}
        console.log("Got queryResult for tag 'test'", queryResult);
    });
    
    pointrel20141201Client.queryByTag("test-nonexistent-tag", function(error, queryResult) {
        if (error) { console.log("error", error); return;}
        console.log("Got queryResult for tag 'test-nonexistent-tag'", queryResult);
    });
});

</script>
</body>
</html>